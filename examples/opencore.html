<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Simple example of Xinha</title>
<script type="text/javascript">
var _editor_url  = document.location.href.replace(/examples\/opencore\.html.*/, '')

var _editor_lang = "en";
</script>
<!-- Load up the actual editor core -->
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script> 

<script type="text/javascript" src="../XinhaCore.js"></script>
<script type="text/javascript">

var xinha_plugins =
[
// 'Linker'
];
var xinha_editors =
[
  'myTextArea',
  'anotherOne'
];

function xinha_init()
{
  if(!Xinha.loadPlugins(xinha_plugins, xinha_init)) return;

  var xinha_config = new Xinha.Config();
  xinha_config.linkValidator = function(editor, a, _lc) {
    var sel = editor.getSelectedHTML();
    if( sel == "dolor" ) return _lc("You can't link dolor!");
  };
  xinha_editors = Xinha.makeEditors(xinha_editors, xinha_config, xinha_plugins);

  Xinha.startEditors(xinha_editors);
}
Xinha.addOnloadHandler(xinha_init);
</script>

</head>

<body>

<form onsubmit="alert(this.myTextArea.value); return false;">
<textarea id="myTextArea" name="myTextArea" rows="25" cols="80">
&lt;p&gt;Lorem ipsum dolor sit amet, consectetuer adipiscing elit.
Aliquam et tellus vitae justo varius placerat. Suspendisse iaculis
velit semper <span id="dolor">dolor</span>.
<span id="donec">((Donec gravida)) tincidunt mi.</span>
Curabitur tristique
ante elementum turpis. Aliquam nisl. Nulla posuere neque non
tellus. Morbi vel nibh. Cum sociis natoque penatibus et magnis dis
parturient montes, nascetur ridiculus mus. Nam nec wisi. In wisi.
Curabitur pharetra bibendum lectus.&lt;/p&gt;
</textarea>
</form>

<h3>
  Test link button (in Chrome, at least)
</h3>
<pre style="float: right;" id="test_link">
var ed = Xinha.getEditor("myTextArea");
var linkButton = ed.config.btnList.createlink[3];

// we can't make a link with no selection
linkButton();

// let's select the word "dolor" now
// our linkValidator function should prevent us
var dolor = ed._doc.getElementById("dolor");
ed.selectNodeContents(dolor);
linkButton();

var node = ed._doc.getElementById("donec");
var text = node.childNodes[0];

ed.selectNodeContents(node);
var sel = ed.getSelection();
var range = ed.createRange(sel);

// let's select the word "Donec"
sel.removeAllRanges();
range.setEnd(text, 5);
sel.addRange(range);

// now we can make a link
linkButton();

</pre>
<button onclick="eval(jQuery('#test_link').text()); return false;">Test it
</button>

</body>
</html>
